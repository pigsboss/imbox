clear
close all
fontsize = 16;
matlist = {...
%     '128x10x16.mat',...
%     '128x100x16.mat',...
%     '128x1000x16.mat',...
%     '128x100x20.mat',...
    '512x10x16.mat',...
    '512x20x16.mat',...
    '512x50x16.mat',...
    '512x100x16.mat',...
    '512x200x16.mat',...
    '512x500x16.mat',...
    '512x1000x16.mat',...
    '512x2000x16.mat',...
    '512x5000x16.mat',...
    };
figure('Name','Bootstrap precision')
lstyles = {'x-r','o-r','.-r','x-b','o-b','.-b','x-k','o-k','.-k'};
nmats = length(matlist);
for n = 1:nmats
    load(matlist{n});
    loglog(M,std(sigma,0,2)*sqrt(N),lstyles{n})
    hold all
end
axis([2 2^17 8e-3 0.8])
xlabel('N_{BS}','fontname','helvetica','fontsize',fontsize)
ylabel('\sigma_{BS} / \sigma','fontname','helvetica','fontsize',fontsize)
title('Bootstrap precision','fontname','helvetica','fontsize',fontsize)
hl = legend('N = 10','N = 20','N = 50',...
    'N = 100','N = 200','N = 500',...
    'N = 1000','N = 2000','N = 5000','Location','SouthEastOutside');
% hl = legend('N = 10','N = 20','N = 50',...
%     'N = 100','N = 200','N = 500',...
%     'N = 1000','Location','Northeast');
set(gca,'xtick',2.^(2:4:16))
set(gca,'ytick',[0.01 0.04 0.16 0.64])
set(gca,'PlotBoxAspectRatio',[3 2 1])
set(gca,'fontname','helvetica','fontsize',fontsize)
set(hl,'box','off','fontsize',fontsize-4)
% hlpos = get(hl,'Position');
% set(hl,'Position',[hlpos(1)-0.1 hlpos(2)-0.06 hlpos(3)+0.12 hlpos(4)])
print('-depsc2','bootstrapcal.eps')
