function L=dlt2(varargin)
%DLT2 discrete Laplace transform of 2D array
%
%Syntax:
%   L = dlt2(F,order)
%   L = dlt2(F)
%
%Input arguments:
%   F     is a 2D array
%   order (optional) is order of accuracy of numerical finit difference used to
%   appximate derivatives.
%

F = varargin{1};
order_d = 2;
narginchk(1,2)
if nargin == 2
    order = varargin{2};
else
    order = order_d;
end
order = min(max(order,2),8);
if order < 4
    h = [0  1 0;...
         1 -4 1;...
         0  1 0];
elseif order < 6
    h = [0       0  -1/12    0      0;...
         0       0    4/3    0      0;...
        -1/12  4/3     -5  4/3  -1/12;...
         0       0    4/3    0      0;...
         0       0  -1/12    0      0];
elseif order < 8
    h = [   0      0    0    1/90    0      0     0;...
            0      0    0   -3/20    0      0     0;...
            0      0    0     3/2    0      0     0;...
         1/90  -3/20  3/2   -49/9  3/2  -3/20  1/90;...
            0      0    0     3/2    0      0     0;...
            0      0    0   -3/20    0      0     0;...
            0      0    0    1/90    0      0     0];
else
    h = [     0      0     0    0   -1/560    0     0      0       0;...
              0      0     0    0    8/315    0     0      0       0;...
              0      0     0    0     -1/5    0     0      0       0;...
              0      0     0    0      8/5    0     0      0       0;...
         -1/560  8/315  -1/5  8/5  -205/36  8/5  -1/5  8/315  -1/560;...
              0      0     0    0      8/5    0     0      0       0;...
              0      0     0    0     -1/5    0     0      0       0;...
              0      0     0    0    8/315    0     0      0       0;...
              0      0     0    0   -1/560    0     0      0       0];
end
L = imconv(F,h,'symmetric');
% L = sdwt2(F,1,h);
return